function setCookie(t, a, n) { var e = new Date; e.setTime(e.getTime() + 60 * n * 1e3), document.cookie = t + "=" + encodeURIComponent(a) + ";expires=" + e.toGMTString(), console.log(document.cookie) }
function getCookie(t) { for (var a = document.cookie.split("; "), n = 0; n < a.length; n++) { var e = a[n].split("="); if (e[0] == t) { var i = decodeURIComponent(e[1]); return i } } return "" }
function fnGetDistance(t) { var a = { lat: 0, lng: 0, ajaxUrl: "", ajaxSucCall: null, ajaxErrCall: null }; $.extend(a, t), $.ajax({ type: "GET", url: a.ajaxUrl, data: { lat: a.lat, lng: a.lng }, dataType: "json", beforeSend: function () { }, success: function (t) { "0" == t.status && t.data ? null != a.ajaxSucCall && a.ajaxSucCall(t.data) : null != a.ajaxErrCall && a.ajaxErrCall() } }) } var numberPad = function (t) { this.opt = { boxObj: ".u-number", minObj: ".u-num-min", plusObj: ".u-num-add", iptObj: ".u-num-ipt", changeCallBack: function () { } }; var a = this, n = this.opt; $.extend(n, t), a.numVal = 1, a.init = function () { $(n.iptObj).on("blur", function () { a.numVal = parseInt($(n.iptObj).val()), a.minTest(), a.plusTest(), n.changeCallBack() }), $(n.minObj).on("click", function () { a.min() }), $(n.plusObj).on("click", function () { a.plus() }), a.plusTest() }, a.min = function () { $(n.minObj).hasClass("disabled") || (a.numVal = parseInt($(n.iptObj).val()) - 1, $(n.iptObj).val(a.numVal), a.minTest(), a.plusTest(), n.changeCallBack()) }, a.plus = function () { $(n.plusObj).hasClass("disabled") || (a.numVal = parseInt($(n.iptObj).val()) + 1, $(n.iptObj).val(a.numVal), a.minTest(), a.plusTest(), n.changeCallBack()) }, a.minTest = function () { a.numVal > 1 ? $(n.minObj).removeClass("disabled") : (a.numVal = 1, $(n.iptObj).val(a.numVal), $(n.minObj).addClass("disabled")) }, a.plusTest = function () { if ($(n.iptObj).data("max")) { var t = parseInt($(n.iptObj).data("max")), e = parseInt($(n.iptObj).data("umax")); a.numVal >= t ? (t > 1 && (t == e ? tip.show("您已达到最大单次购买数量") : tip.show("您已达到最大限购数量：" + t)), a.numVal = t, $(n.iptObj).val(a.numVal), $(n.plusObj).addClass("disabled")) : $(n.plusObj).removeClass("disabled") } else 0 == $(n.iptObj).data("max") && $(n.plusObj).addClass("disabled") }, a.getNum = function () { return a.numVal }, a.init() }; $(function () { var t = ".js-sw-container"; $(t).length && ($(".js-sw-max").html($(t).find("ul > li").length), "undefined" != typeof Swiper && new Swiper(t, { onTransitionStart: function (t) { $(".js-sw-curr").html(t.activeIndex + 1) } }), $(".js-sw-container").on("click", function () { var t = $(".swiper-slide-active").index(); "undefined" != typeof WeixinJSBridge && pic_list.length > 0 && WeixinJSBridge.invoke("imagePreview", { current: pic_list[t], urls: pic_list }) })) }); var proList = function (t) { this.opt = { boxCls: ".js-slst-box", moreCls: ".js-slst-more", moreTxtCls: ".js-tuan-more", page: 2, ajaxUrl: "", getTemp: function () { } }, $.extend(this.opt, t), this.init() }; proList.prototype = { init: function () { var t = this, a = t.opt; $(a.moreCls).on("click", function () { if ($(a.boxCls).children("li.hidden").length) $(a.boxCls).children("li.hidden").removeClass("hidden"), t.fnMoreInit(); else if (a.ajaxUrl) { var n = { page: a.page }; $.getJSON(a.ajaxUrl, n, function (n) { "0" == n.status && null != n.data && n.data.length > 0 ? ($(a.getTemp(n.data)).insertBefore(a.moreCls), a.page++, t.fnMoreInit()) : "" != n.error && tip.show(n.error) }) } }), t.fnMoreInit() }, fnMoreInit: function () { var t = this, a = t.opt, n = $(a.boxCls).children("li:not(.hidden)").length - 1, e = $(a.boxCls).data("maxnum"); if (e > n) { var i = e - n; $(a.moreTxtCls).html(i) } else $(a.moreCls).remove() } }; var MapGeolocation = function (t) { if (console.log(document.cookie.indexOf("mapGeolocation")), "undefined" != typeof BMap && document.cookie.indexOf("mapGeolocation") == -1) { var a = new BMap.Geolocation; a.getCurrentPosition(function (a) { this.getStatus() == BMAP_STATUS_SUCCESS && a.accuracy ? (t(a.point.lat, a.point.lng, 0), setCookie("mapGeolocation", a.point.lat + "," + a.point.lng, 3)) : (t(0, 0, 1), setCookie("mapGeolocation", "0,0", 3)) }, { enableHighAccuracy: !0 }) } else { var n = getCookie("mapGeolocation").split(","); t(n[0], n[1], 2) } }; !function (t) { t.fn.serializeJson = function () { var a = {}, n = this.serializeArray(); this.serialize(); return t(n).each(function () { a[this.name] ? t.isArray(a[this.name]) ? a[this.name].push(this.value) : a[this.name] = [a[this.name], this.value] : a[this.name] = this.value }), a } }(Zepto); var fmAjaxSubmit = function (t) { this.opt = { ajaxUrl: "", ajaxData: {}, wrapper: "#fmData", trigger: "[type='submit']", validate: function () { return !0 }, ajaxSucCall: function () { } }, $.extend(this.opt, t); var a = this, n = a.opt; this.init = function () { $(n.trigger, n.wrapper).on("click", function () { n.validate() && ($.extend(n.ajaxData, a.getFormData()), a.ajaxPost()) }) }, this.setAjaxUrl = function (t) { n.ajaxUrl = t }, this.setAjaxData = function (t) { $.extend(n.ajaxData, t) }, this.ajaxPost = function () { $.ajax({ url: n.ajaxUrl, type: "post", dataType: "json", data: n.ajaxData, success: function (t) { 0 == t.status ? n.ajaxSucCall(t.data) : "" != t.error && tip.show(t.error) } }) }, this.getFormData = function () { return $(n.wrapper).serializeJson() }, this.init() };